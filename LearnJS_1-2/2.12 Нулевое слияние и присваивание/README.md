# Операторы нулевого слияния и присваивания: '??', '??='

<h2>'??'</h2>

- [ ] Оператор нулевого слияния (??) обрабатывает `null и undefined` одинаковым образом, таким образом указывая - определено значение или нет.

  + Результат выражения `a ?? b` будет следующим:

    + если `a` определено, то `a`,
    + если `a` не определено, то `b`.

```javascript
// Вот как это будет с условным оператором `?`
  result = (a !== null && a !== undefined) ? a : b;
```

  + Иначе говоря, оператор `??` возвращает первый аргумент, если он не `null/undefined`, иначе второй.
  + Оператор нулевого слияния не является чем-то принципиально новым. Это всего лишь удобный синтаксис, как из двух значений получить одно, которое «определено».

ПРИМЕРЫ ЕЩЕ

```javascript
  let user;

  console.log(user ?? "Аноним"); // Аноним (user не существует)

  //

  let user = "Иван";

  console.log(user ?? "Аноним"); // Иван (user существует)
```

<br>

  + Кроме этого, можно записать `последовательность` из операторов `??`, чтобы получить первое значение из списка, которое не является `null/undefined`.

  ```javascript
    let firstName = null;
    let lastName = null;
    let nickName = "Суперкодер";
    
    // показывает первое значение, которое определено:
    console.log(firstName ?? lastName ?? nickName ?? "Аноним"); // Суперкодер
  ```

<hr>
<br>
<br>

<h2>Сравнение с ||</h2>

- [ ] Оператор `ИЛИ |`| можно использовать для того же, что и `??`

```javascript
// Если в приведённом выше коде заменить ?? на ||, то будет тот же самый результат:
  let firstName = null;
  let lastName = null;
  let nickName = "Суперкодер";
  
  // показывает первое истинное значение:
  console.log(firstName || lastName || nickName || "Аноним"); // Суперкодер
```

- [x] Важное различие между ними заключается в том, что:

  + `||` возвращает первое `истинное` значение.
  + `??` возвращает первое `определённое` значение. (т/е не `null` или `undefined`)
     
  ```javascript
    let height = 0;

    console.log(height || 100); // 100 - вернет первое true => это 100
    console.log(height ?? 100); // 0 - вернет первое определенное зн. => это 0 (он определен / задан)
  ```

<br>

  <h3>- Приоритет</h3>
  
  + Приоритет оператора `??` такой же, как и у `||`. Они оба равны 3 в таблице на MDN.
  + Это означает, что, как и `||`, оператор нулевого слияния `??` вычисляется до `= и ?`, но после большинства других операций, таких как `+, *`.
  + Так что, в выражениях такого вида понадобятся скобки:

<br>

  <h3>- Использование ?? вместе с && или ||</h3>

  + По соображениям безопасности JavaScript запрещает использование оператора `??` вместе с `&& и ||`, если приоритет явно не указан при помощи круглых скобок.

  ```javascript
    let x = 1 && 2 ?? 3; // Синтаксическая ошибка
  ```

  + Используйте скобки, чтобы обойти это ограничение:

  ```javascript
    let x = (1 && 2) ?? 3; // Работает без ошибок

    console.log(x); // 2
  ```

<hr>
<br>
<br>

<h2>Оператор нулевого присваивания (??=)</h2>

- [ ] Предположим, нам необходимо проверить, равна ли переменная `null` или `undefined`, и если это так — присвоить этой переменной какое-либо другое значение.

```javascript
// Старый вариант
  let userAge = null;

  if (userAge === null || userAge === undefined) {
    userAge = 18;
  }
```

- [ ] Теперь при помощи `??=`

  + Оператор `??=` присвоит x значение y только в том случае, если x не определено (`null/undefined`).

```javascript
  x ??= y
```

```javascript
  let userAge = null;

  userAge ??= 18;
  
  console.log(userAge) // 18

// Если userAge не равен null / undefined (определено)
// То выражение справа не сработает

let userAge = 18;

userAge ??= alert("не сработает");
userAge ??= 21;
userAge ??= null;

console.log(userAge) // по-прежнему 18
```
